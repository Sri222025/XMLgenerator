@echo off
echo ========================================
echo Installing IDU XML Generator Dependencies
echo ========================================
echo.

REM Try different Python commands
echo Trying to find Python 3.11...
echo.

REM Try python3.11
python3.11 -m pip install openpyxl xlrd 2>nul
if %errorlevel% == 0 (
    echo.
    echo Successfully installed dependencies using python3.11!
    goto :end
)

REM Try python3
python3 -m pip install openpyxl xlrd 2>nul
if %errorlevel% == 0 (
    echo.
    echo Successfully installed dependencies using python3!
    goto :end
)

REM Try python
python -m pip install openpyxl xlrd 2>nul
if %errorlevel% == 0 (
    echo.
    echo Successfully installed dependencies using python!
    goto :end
)

REM Try py launcher
py -3.11 -m pip install openpyxl xlrd 2>nul
if %errorlevel% == 0 (
    echo.
    echo Successfully installed dependencies using py -3.11!
    goto :end
)

REM If all fail, show instructions
echo.
echo ERROR: Could not find Python installation.
echo.
echo Please install dependencies manually:
echo.
echo Option 1: If Python 3.11 is installed, find it and run:
echo    [Python3.11Path]\python.exe -m pip install openpyxl xlrd
echo.
echo Option 2: Or install all requirements:
echo    [Python3.11Path]\python.exe -m pip install -r requirements_idu_xml.txt
echo.
echo Option 3: Add Python to your PATH, then run:
echo    pip install openpyxl xlrd
echo.
echo Common Python 3.11 installation paths:
echo    C:\Python311\python.exe
echo    C:\Users\%USERNAME%\AppData\Local\Programs\Python\Python311\python.exe
echo    C:\Program Files\Python311\python.exe
echo.

:end
pause

